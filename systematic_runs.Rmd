---
title: "Systematic_run"
author: "Sarah Leutner"
date: "2024-07-06"
output: pdf_document
include-before: "<style>\nbody { max-width: 1000px; font-family: Candara, sans-serif;
  margin: auto; }\npre  { font-family: Consolas; monospaced;  }\ntable { \n    min-width:
  400px; border-spacing: 5px;  \n    border-collapse: collapse; \n    border-bottom:
  2px solid #333333;\n}\ntd, th { padding: 10px 20px; }\nth { background-color: #eeeeee;
  border: 2px 0px; }\nthead { border-top: 2px solid #333333; border-bottom: 2px solid
  #333333; }  \n#abstract {\n    margin: 2.5em;\n    font-size: 90%;\n}\nh1, p.date,
  p.author { text-align: center }\n</style>\n"
vignette: "%\\VignetteIndexEntry{Larger models} %\\VignetteEngine{knitr::rmarkdown}
  %\\VignetteEncoding{UTF-8}\n"
---

```{r include=FALSE}
knitr::opts_chunk$set(comment = "###")
```




## Introduction

Simulation with 1000 agents:


```{r}
library(hanna)
t1=Sys.time()
source("hnl.R")
hnl$new(1000)
hanna::simul$gini(hnl$token)
barplot(table(hnl$token))
hanna::simul$gini(hnl$token)

# simulation without TAX rate
# after first iterations set
for (i in 1:3) {
    hnl$iter(tax_rate = 0)
}   
barplot(table(hnl$token))
hanna::simul$gini(hnl$token)

# after second iteration set
for (i in 1:3) {
    hnl$iter(tax_rate = 0)
}   
barplot(table(hnl$token))
hanna::simul$gini(hnl$token)

# ------------------------------------------------------
# # simulation with TAX rate
# after first iteration set
for (i in 1:3) {
    hnl$iter(tax_rate = 0.1)
}   
barplot(table(hnl$token))
hanna::simul$gini(hnl$token)

# after second iteration set
for (i in 1:3) {
    hnl$iter(tax_rate = 0.1)
}   
barplot(table(hnl$token))
hanna::simul$gini(hnl$token)

print(Sys.time()-t1)




```

```{r function}
source("functions/add_row.R")

triads_df <- data.frame(
  method = character(), 
  iteration = numeric(),
  agents = numeric(), 
  neighbour = numeric(), 
  tax_rate = numeric(), 
  gini_coefficient = numeric(),
  dd = numeric(), 
  ds = numeric(), 
  pa = numeric(), 
  tr = numeric(), 
  cy = numeric(), 
  stringsAsFactors = FALSE
)
```


# Systematic runs WINNER LOSER MODEL

#```{r label=50n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run1/winlo_10ind_10nei.png", width = 1400, height = 1000)

set.seed(42)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=10)
for (i in 1:20) {
    A = hnl$iter(region = 5, tax_rate = 0)
    A = ifelse(is.na(A) | A == -1, 0, A)
    num_digits = nchar(nrow(A))
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    
    if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triad1 <- add_row(triad1, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 10,
                             neighbour = 10, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
    }
}  

dev.off()
#```

```{r label=50n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/winlo_10ind_10nei_tax10.png", width = 1400, height = 1000)

set.seed(187)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=10)
for (i in 1:20) {
    A = hnl$iter(region = 5, tax_rate = 0.10)
    A = ifelse(is.na(A) | A == -1, 0, A)
    num_digits = nchar(nrow(A))
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    
    if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 10,
                             neighbour = 10, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
    }
}  

dev.off()
```

## no tax
#```{r label=50n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run5/winlo_20ind_20nei.png", width = 1400, height = 1000)

set.seed(404)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=20)
for (i in 1:20) {
    A = hnl$iter(region = 10, tax_rate = 0)
    A = ifelse(is.na(A) | A == -1, 0, A)
    num_digits = nchar(nrow(A))
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    
    if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 20,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
    }
}  

dev.off()
#```

```{r label=50n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/winlo_20ind_20nei_tax10.png", width = 1400, height = 1000)

set.seed(187)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=20)
for (i in 1:20) {
    A = hnl$iter(region = 10, tax_rate = 0.10)
    A = ifelse(is.na(A) | A == -1, 0, A)
    num_digits = nchar(nrow(A))
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    
    if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 20,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
    }
}  

dev.off()
```

#```{r label=50n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run5/winlo_50ind_20nei.png", width = 1400, height = 1000)

set.seed(404)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=50)
for (i in 1:20) {
    A = hnl$iter(region = 10, tax_rate = 0)
    A = ifelse(is.na(A) | A == -1, 0, A)
    num_digits = nchar(nrow(A))
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    
    if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 50,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
    }
}  

dev.off()
#```


## Systematic runs WITH TAX MODEL (neighbors=20,model=winlo)

```{r label=50n20win_tax,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/winlo_50ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=50)
for (i in 1:20) {
    A=hnl$iter(region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
     if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 50,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}   
dev.off() # WORKED
```
## Systematic runs (neighbors=20,model=winlo)

#```{r label=100n20win,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run5/winlo_100ind_20nei.png", width = 1600, height = 1200)

set.seed(404)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=100)
for (i in 1:20) {
    A=hnl$iter(region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
      if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 100,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}

dev.off()
#```

## Systematic runs WITH TAX MODEL (neighbors=20,model=winlo)

```{r label=100n20win_tax,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/winlo_100ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=100)
for (i in 1:20) {
    A=hnl$iter(region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
      if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 100,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}

dev.off()
```


## Systematic runs (neighbors=20,model=winlo)

#```{r label=n30win, fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run5/winlo_200ind_20nei.png", width = 1600, height = 1200)

set.seed(404)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=200)
for (i in 1:20) {
    A=hnl$iter(region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
      if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 200,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}

dev.off()
#```


## Systematic runs WITH TAX MODEL (neighbors=30,model=winlo)

```{r label=n30win_tax, fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/winlo_200ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)
par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=200)
for (i in 1:20) {
    A=hnl$iter(region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
      if (i %in% c(1, 5, 10, 20)) {
        cols = rep("chartreuse3", nrow(A))
        cols[hnl$token > 1] = "orange"
        cols[hnl$token > 9] = "firebrick3"
        hgraph$plot(A, vertex.color = cols, main = paste("iter =", i), layout = "sam")
        barplot(table(hnl$token), main = paste("Gini =", round(hanna::simul$gini(hnl$token), 2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "winner_loser", 
                             iteration = i,
                             agents = 200,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}

dev.off()
```

# Systematic runs on NULL_MODEL
#```{r}
png("images/systematic/run1/null_10ind_10nei.png", width = 1600, height = 1200)

set.seed(42)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=10)
for (i in 1:20) {
    A=hnl$iter(model="null",region=5, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triad1 <- add_row(triad1, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 10,
                             neighbour = 10, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}


dev.off()
#```

```{r}
png("images/systematic/run3/tax10/null_10ind_10nei_tax10.png", width = 1600, height = 1200)

set.seed(187)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=10)
for (i in 1:20) {
    A=hnl$iter(model="null",region=5, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 10,
                             neighbour = 10, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}


dev.off()
```

## no tax

#```{r}
png("images/systematic/run5/null_20ind_20nei.png", width = 1600, height = 1200)

set.seed(404)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=20)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 20,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}


dev.off()
#```

```{r}
png("images/systematic/run3/tax10/null_20ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=20)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 20,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}


dev.off()
```

#```{r label=null,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run5/null_50ind_20nei.png", width = 1600, height = 1200)

set.seed(404)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=50)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 50,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}


dev.off()
#```




## Systematic runs WITH TAX MODEL (neighbors=10,model=null)

```{r label=null_tax,fig.width=24,fig.heigth=24,out.width=1000}
png("images/systematic/run3/tax10/null_50ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=50)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 50,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}


dev.off()
```



#```{r}
png("images/systematic/run5/null_100ind_20nei.png", width = 1600, height = 1200)

set.seed(404)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=100)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 100,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}


dev.off()
#```


```{r}
png("images/systematic/run3/tax10/null_100ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=100)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 100,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}


dev.off()
```

#```{r}
png("images/systematic/run5/null_200ind_20nei.png", width = 1600, height = 1200)

set.seed(404)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=200)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 200,
                             neighbour = 20, 
                             tax_rate = 0, 
                             gini_coefficient = gini)
     }
}


dev.off()
#```

```{r}
png("images/systematic/run3/tax10/null_200ind_20nei_tax10.png", width = 1600, height = 1200)

set.seed(187)

par(mfcol=c(3,4),mai=rep(0.3,4))
hnl$new(n=200)
for (i in 1:20) {
    A=hnl$iter(model="null",region=10, tax_rate=0.10)
    A = ifelse(is.na(A) | A == -1, 0, A) # display NA's and -1 as 0
    num_digits = nchar(nrow(A)) # get number of digits
    rownames(A) = colnames(A) = sprintf(paste0("%0", num_digits, "i"), 1:nrow(A)) 
    if (i %in% c(1, 5, 10, 20)) {
        cols=rep("chartreuse3",nrow(A))
        cols[hnl$token>1]="orange"
        cols[hnl$token>9]="firebrick3"
        hgraph$plot(A,vertex.color=cols,main=paste("iter =",i),layout="sam")
        barplot(table(hnl$token),main=paste("Gini =",  round(hanna::simul$gini(hnl$token),2)))
        dotchart(unlist(hgraph$triads(A)))
        
        # Calculate Gini coefficient
        gini <- round(hanna::simul$gini(hnl$token), 2)
        
        # Add data to triads_df using add_row function
        triads_df <- add_row(triads_df, 
                             unlist(hgraph$triads(A)), 
                             method_name = "null", 
                             iteration = i,
                             agents = 200,
                             neighbour = 20, 
                             tax_rate = 0.10, 
                             gini_coefficient = gini)
     }
}


dev.off()
```
```{r}
write.table(triads_df, "data/tax10/systematic_Run3.txt", quote=F, sep = "\t", row.names = F)
#triad1 <- read.table("data/systematic_Run1.txt", header = T)
```

used seeds:
42, 134, 187, 444, 404

generally the Null models, so societies without any "rules" except for providing the same chance for all also exhibit strong dominance hierarchies over time, with only a few indivduals being in the center and wealthier. the winner loser model (without tax) just enhances this effect, but it does not cause it apperently